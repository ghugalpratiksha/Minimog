if(!customElements.get("foxkit-quantity-selector")){class t extends HTMLElement{constructor(){super()}connectedCallback(){this.input=this.querySelector("input"),this.changeEvent=new Event("change",{bubbles:!0}),this.productId=this.dataset.productId,this.querySelectorAll("button").forEach((t=>{t.onclick=null,t.onclick=t=>{this.onButtonClick(t)}})),this.input.addEventListener("change",(()=>{this.input.value<=1&&(this.input.value=1)}))}onButtonClick(t){t.preventDefault();const e=this.input.value;"plus"===t.target.name?this.input.stepUp():this.input.stepDown(),e!==this.input.value&&this.input.dispatchEvent(this.changeEvent)}}customElements.define("foxkit-quantity-selector",t)}class FoxKitProductCard extends HTMLElement{constructor(){super(),this.selectors={price:".foxkit-product-card__price, [foxkit-card-price]",compareAtPrice:".foxkit-product-card__compare-price, [foxkit-card-compare-price]",image:".spc__main-img img",form:"form",submitBtn:'button[name="add"]'}}connectedCallback(){this.mCartDrawer=document.querySelector("m-cart-drawer"),this.zCartDrawer=document.querySelector("drawer-component#Drawer-Cart cart-drawer"),this.mCartMain=document.querySelector("m-cart-template"),this.zCartMain=document.querySelector("cart-items.f-cart"),this.isInCart=!!this.closest('form[action*="/cart"]'),this.domNodes=FoxKitV2.Utils.queryDomNodes(this.selectors,this),this.errorWrapper=this.dataset.errorWrapper?document.querySelector(this.dataset.errorWrapper):this,this.addEventListener("change",this.onVariantChange.bind(this)),this.domNodes.submitBtn&&this.domNodes.submitBtn.addEventListener("click",this.onSubmitHandler.bind(this))}disConnectedCallback(){this.removeEventListener("change",this.onVariantChange.bind(this)),this.domNodes.submitBtn&&this.domNodes.submitBtn.removeEventListener("click",this.onSubmitHandler.bind(this))}setupData(t){this.productData=t}onVariantChange(t){const{target:e}=t;if(!("id"===e.getAttribute("name"))||!this.productData)return;const i=Number(e.value);this.selectedVariant=this.productData.variants.find((t=>t.id===i));const{price:o,compare_at_price:s,featured_image:a}=this.selectedVariant;this.domNodes.price.textContent=FoxKitV2.Utils.formatMoney(o,FoxKitSettings.moneyFormat),a&&this.domNodes.image&&(this.domNodes.image.src=`${a.src}&width=300`),s?(this.domNodes.compareAtPrice.textContent=FoxKitV2.Utils.formatMoney(s,FoxKitSettings.moneyFormat),this.domNodes.compareAtPrice.classList.remove("foxkit-hidden")):this.domNodes.compareAtPrice.classList.add("foxkit-hidden")}onSubmitHandler(t){if(t.preventDefault(),this.domNodes.submitBtn.classList.contains("foxkit-spinner--loading"))return;this.domNodes.submitBtn.classList.add("foxkit-spinner--loading");const e={method:"POST",headers:{Accept:"application/javascript","X-Requested-With":"XMLHttpRequest"}},i=new FormData(this.domNodes.form);this.zCartDrawer&&(i.append("sections",this.zCartDrawer.getSectionsToRender().map((t=>t.id))),i.append("sections_url",window.location.pathname)),this.zCartMain&&(i.append("sections",this.zCartMain.getSectionsToRender().map((t=>t.section))),i.append("sections_url",window.location.pathname)),e.body=i;const{FoxKitSettings:o}=window;fetch(`${o.routes.cart_add_url}`,e).then((t=>t.json())).then((async t=>{if(t&&t.id){if(!o.enableAjaxAtc&&"pre-purchase"===this.dataset.plugin)return window.FoxKitV2.goToCart();window.MinimogTheme?(this.mCartDrawer&&await this.mCartDrawer.onCartDrawerUpdate(!window.FoxKitV2.hasDiscount),this.mCartMain&&await this.mCartMain.onCartUpdate(!window.FoxKitV2.hasDiscount),window.FoxKitV2.initCart(),this.isInCart||this.showNotification(t)):window.FoxTheme?(this.zCartDrawer&&await this.zCartDrawer.renderContents(t),this.zCartMain&&await this.zCartMain.renderContents(t),window.FoxKitV2.Modules.InCart&&FoxKitPlugins.InCart.length>0&&window.FoxKitV2.Modules.InCart.getCart(),window.FoxKitV2.initCart(),this.isInCart||this.showNotification(t)):("cart"===window.FoxKitSettings.template&&setTimeout((()=>{window.location.reload()}),500),this.showNotification(t))}else t&&422===t.status&&FoxKitV2.Modules.Notification.show({target:this,method:"appendChild",type:"warning",message:t.description||"Cannot add this item to cart"})})).catch((t=>{})).finally((()=>{this.domNodes.submitBtn.classList.remove("foxkit-spinner--loading")}))}showNotification(t){FoxKitV2.Modules.Notification.show({target:this.errorWrapper?this.errorWrapper:document.body,method:"appendChild",type:"success",message:window.__i18n.tr("item_added_to_cart",{product_title:t.product_title}),last:3e3,sticky:!this.errorWrapper})}}customElements.define("foxkit-product-card",FoxKitProductCard);