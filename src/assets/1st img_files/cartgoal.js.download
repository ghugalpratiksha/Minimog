customElements.define("foxkit-cart-goal",class extends HTMLElement{constructor(){if(super(),!window.FoxKitThemeHelperEnabled)return;this.selectors={cartContainer:".scd__content, cart-items",cartFooter:"#main-cart-footer, .cart-footer, .cart__footer, .sf-cart__summary",cartSubtotal:"[data-cart-subtotal], .cart__footer .totals, #main-cart-footer .totals",shippingNote:"[data-shipping-note], .tax-note",title:".foxkit-cartgoal__title",progressBar:"[data-progress]",goalLeft:"[data-goal-left]",icon:".foxkit-cartgoal__icon"},this.defaultIcon='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12"><path fill="currentColor" d="M5.56445.761719C5.69336.503906 5.90104.375 6.1875.375s.49414.128906.62305.386719L8.20703 3.59766l3.13677.47265c.2864.02865.4726.17904.5585.45117.086.27214.0287.50847-.1718.70899L9.45312 7.44336l.53711 3.13674c.04297.2721-.05013.487-.27929.6445-.22917.1719-.4655.1934-.70899.0645L6.1875 9.82812 3.37305 11.2891c-.24349.1432-.47982.1289-.70899-.043-.22916-.1719-.32226-.3939-.27929-.666l.53711-3.13674L.644531 5.23047C.44401 5.02995.386719 4.79362.472656 4.52148c.085938-.27213.272136-.42252.558594-.45117l3.13672-.47265L5.56445.761719z"/></svg>',this.doneIcon='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 12 12"><path fill="currentColor" d="M5.56445.761719C5.69336.503906 5.90104.375 6.1875.375s.49414.128906.62305.386719L8.20703 3.59766l3.13677.47265c.2864.02865.4726.17904.5585.45117.086.27214.0287.50847-.1718.70899L9.45312 7.44336l.53711 3.13674c.04297.2721-.05013.487-.27929.6445-.22917.1719-.4655.1934-.70899.0645L6.1875 9.82812 3.37305 11.2891c-.24349.1432-.47982.1289-.70899-.043-.22916-.1719-.32226-.3939-.27929-.666l.53711-3.13674L.644531 5.23047C.44401 5.02995.386719 4.79362.472656 4.52148c.085938-.27213.272136-.42252.558594-.45117l3.13672-.47265L5.56445.761719z"/></svg>',this.progress=0,this.goalDone=!1,this.enabled=!0,this.domNodes=FoxKitV2.Utils.queryDomNodes(this.selectors,this),this.settings=FoxKitPlugins.CartGoal,this.goal=Number(this.settings.goal_amount)*Number(window.Shopify.currency.rate||1)||0,this.reached_message=this.settings.message_reached,this.message=this.settings.message,this.freeBadge=document.querySelector("#foxkit-shipping-note")?.content.firstElementChild.cloneNode(!0);const t=this.closest(this.selectors.cartContainer),e=document.querySelector(this.selectors.cartFooter);t&&t.classList.add("scd--has-cartgoal"),e&&(this.shippingNote=e.querySelector(this.selectors.shippingNote),this.cartSubtotal=e.querySelector(this.selectors.cartSubtotal)),this.handleChange(),this.confettiShow=this.goalDone}updateProgress=async t=>{t||(t=await FoxKitV2.getCart()),this.enabled=t.requires_shipping;const e=t._foxCartPrices?t._foxCartPrices.total_price:t.total_price;this.goalLeft=100*this.goal-e,this.progress=this.goalLeft>0?e/this.goal:100,this.goalDone=this.goalLeft<=0,this.goalTitle=this.goalDone?this.reached_message:this.message,this.domNodes.icon&&(this.domNodes.icon.innerHTML=this.goalDone?this.doneIcon:this.defaultIcon),this.style.setProperty("--progress",this.progress+"%"),this.goalTitle=this.goalTitle.replace("{{variable}}",`<strong>${FoxKitV2.Utils.formatMoney(this.goalLeft,FoxKitSettings.moneyFormat)}</strong>`),setTimeout((()=>{const t=this.goalDone?"add":"remove";this.querySelector(this.selectors.title).innerHTML=this.goalTitle,this.classList[t]("foxkit-cartgoal--done")}),500),this.setDone(),this.enabled?this.classList.remove("foxkit-hidden"):(this.classList.add("foxkit-hidden"),this.freeBadge&&this.freeBadge.remove())};handleChange=()=>{window.FoxkitEvents.subscribe("ON_FOXKIT_CART_UPDATE",(t=>{if(t){this.domNodes=FoxKitV2.Utils.queryDomNodes(this.selectors),this.updateProgress(t);const e=this.goalDone?"add":"remove";this.classList[e]("shakeY"),this.goalLeft<=0?this.showConfetti():this.confettiShow=!1}}))};setDone=()=>{this.freeBadge&&this.freeBadge.remove(),this.shippingNote&&this.shippingNote.classList.remove("foxkit-hidden"),this.goalDone&&this.enabled?(window.FoxKitV2.freeShip=!0,this.addShippingNote()):window.FoxKitV2.freeShip=!1};showConfetti=()=>{this.enabled&&!this.confettiShow&&(new window.FoxKitV2.Modules.Confetti(document.querySelector(this.selectors.cartContainer)),this.confettiShow=!0)};addShippingNote=()=>{this.freeBadge.querySelector(".free-label").textContent=window.__i18n.tr("free"),this.freeBadge.querySelector(".shipping-label").textContent=window.__i18n.tr("shipping_label"),this.cartSubtotal&&this.domNodes.cartSubtotal.before(this.freeBadge),this.shippingNote&&this.shippingNote.classList.add("foxkit-hidden")}});